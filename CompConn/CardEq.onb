<!DOCTYPE OMNotebook>
<Notebook>
 <GroupCell closed="false" >
  <GroupCell closed="false" >
   <TextCell style="Title" >
    <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Arial; font-size:38pt; font-weight:600; color:#000000;">Cardinality Dependent Connection Equations&lt;/p>&lt;/body>&lt;/html></Text>
   </TextCell>
   <GroupCell closed="false" >
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times; font-size:18pt; font-weight:600; color:#000000;">CardinalityResistor&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">In certain cases there is a need to let the behavior of a model be dependent on the number of connections to certain connectors of the model. Below is an example class containing a conditional if-clause equation with a condition that is a parameter expression (the built-in function cardinality has parameter variability), i.e.the condition does not change during simulation. The function &lt;span style=" font-family:Courier New;">cardinality&lt;/span>(&lt;span style=" font-style:italic;">c&lt;/span>) with formal parameter &lt;span style=" font-style:italic;">c&lt;/span> returns the total number of (internal and external) occurrences of the connector &lt;span style=" font-style:italic;">c&lt;/span> in &lt;span style=" font-family:Courier New;">connect&lt;/span> statements in the total model.&lt;br />&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model CardinalityResistor
  extends Modelica.Electrical.Analog.Interfaces.OnePort;
  parameter Real R(unit = "Ohm")    "Resistance";
equation

  // Handle cases if pins are not connected
  if cardinality(p) == 0 and cardinality(n) == 0 then
    p.v = 0;
    n.v = 0;
  elseif cardinality(p) == 0 then
    p.i = 0;
  elseif cardinality(n) == 0 then
    n.i = 0;
  end if;

  // Resistor equation
  v = R * i;
end CardinalityResistor;</Input>
     <Output>Ok</Output>
    </InputCell>
   </GroupCell>
   <GroupCell closed="false" >
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times; font-size:18pt; font-weight:600; color:#000000;">Simulation of CardinalityResistor &lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model circuit
  CardinalityResistor R1( R=100 );
  Modelica.Electrical.Analog.Basic.Ground Gnd;
  Modelica.Electrical.Analog.Sources.SineVoltage U1;
equation
  connect( R1.n, U1.n );
  connect( R1.p, Gnd.p );
  connect( U1.p, Gnd.p );
end circuit;</Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">Simulate it!&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>simulate( circuit ) //??Error</Input>
     <Output>record
    resultFile = "circuit_res.plt"
end record
OMC-ERROR:
"Variable V not found in scope Modelica.Electrical.Analog.Interfaces.VoltageSource
Illegal to instantiate partial class SignalSource
"</Output>
    </InputCell>
    <TextCell style="Output" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="true" >
     <Input>plot( R1.v );</Input>
     <Output>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Output>
    </InputCell>
    <TextCell style="Output" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;span style=" color:#000000;">&lt;img src="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/24.png" width="288" height="214" />&lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
     <Image name="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/24.png" >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</Image>
    </TextCell>
   </GroupCell>
  </GroupCell>
 </GroupCell>
</Notebook>
