<!DOCTYPE OMNotebook>
<Notebook>
 <GroupCell closed="false" >
  <GroupCell closed="false" >
   <TextCell style="Title" >
    <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Arial; font-size:38pt; font-weight:600; color:#000000;">Parameterization and Extension of Interfaces&lt;/p>&lt;/body>&lt;/html></Text>
   </TextCell>
   <GroupCell closed="false" >
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times; font-size:18pt; font-weight:600; color:#000000;">Tank&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">External interfaces to component classes are defined primarily through the use of connectors.  Assume that we have a definition of a &lt;span style=" font-family:Courier New;">Tank&lt;/span> model in a model library. The model has an external interface in terms of the connectors &lt;span style=" font-family:Courier New;">inlet&lt;/span> and &lt;span style=" font-family:Courier New;">outlet&lt;/span>, as well as a formal class parameter &lt;span style=" font-family:Courier New;">TankStream&lt;/span> which is a connector class with its default class value being the Stream connector class. (See ModelicaBook page 137)&lt;br /> &lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>connector Stream   //Connector class
  Real pressure;
  flow Real volumeFlowRate;
end Stream;</Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model Tank
  parameter Real area = 1;
  replaceable connector TankStream = Stream;    // Class parameterization
  TankStream inlet, outlet;              // The connectors
  Real level(start=2);
equation
  inlet.volumeFlowRate = 1;
  inlet.pressure = 1;

  // Mass balance
  area * der(level) = inlet.volumeFlowRate + outlet.volumeFlowRate;

  outlet.pressure = inlet.pressure;
  outlet.volumeFlowRate = 2;
end Tank;</Input>
     <Output>Ok</Output>
    </InputCell>
   </GroupCell>
   <GroupCell closed="false" >
    <TextCell style="Subsection" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times; font-size:18pt; font-weight:600; color:#000000;">&lt;span style=" font-size:14pt;">Simulation of Tank &lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>simulate( Tank );</Input>
     <Output>[done]</Output>
    </InputCell>
    <InputCell style="Input" closed="false" >
     <Input>plot(level )</Input>
     <Output>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;img src="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/43.png" width="492" height="250" />&lt;/p>&lt;/body>&lt;/html></Output>
     <Image name="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/43.png" >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</Image>
    </InputCell>
   </GroupCell>
   <GroupCell closed="false" >
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times; font-size:18pt; font-weight:600; color:#000000;">HeatTank&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">We would like to extend the &lt;span style=" font-family:Courier New;">Tank&lt;/span> model to include temperature dependent effects, analogous to how we extended a resistor to a temperature dependent resistor.&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model HeatTank
  extends Tank(redeclare connector TankStream = HeatStream);
  Real level(start=2);
  Real temp;
equation
  inlet.temp = 25;

  // Energy balance for temperature effects
  area*level*der(temp) =
       inlet.volumeFlowRate*inlet.temp +
         outlet.volumeFlowRate*outlet.temp;

  outlet.temp = temp;
end HeatTank;  </Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>connector HeatStream
  extends Stream;
  Real temp;
end HeatStream;</Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Subsection" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;span style=" font-family:Times; font-size:14pt; font-weight:600;">Simulation of HeadTank&lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">Simulate it:&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>instantiateModel(HeatTank)  //??Error in implementation</Input>
     <Output>"variable point1.x  not found in simulation result.
variable point1.x  not found in simulation result.
variable point1.x  not found in simulation result.
variable outlet.pressure  not found in simulation result.
variable outlet.pressure  not found in simulation result.
variable outlet.volumeFlowRate  not found in simulation result.
variable outlet.volumeFlowRate  not found in simulation result.
variable outlet.volumeFlowRate  not found in simulation result.
variable outlet.volumeFlowRate  not found in simulation result.
"
OMC-ERROR:
"Variable inlet.temp not found in scope HeatTank
Error occured while flattening model HeatTank
Error occured while flattening model HeatTank
"</Output>
    </InputCell>
    <InputCell style="Input" closed="false" >
     <Input>clear()</Input>
     <Output>true</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">Simulate it:&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>simulate(HeatTank)</Input>
     <Output>record
    resultFile = "Simulation failed.
Variable inlet.temp not found in scope HeatTank
Error occured while flattening model HeatTank
"
end record</Output>
    </InputCell>
    <InputCell style="Input" closed="true" >
     <Input>plot({level,temp})</Input>
     <Output>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Output>
    </InputCell>
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;span style=" font-family:Times; font-size:18pt; font-weight:600;">HeatTankExpanded&lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">The definition of &lt;span style=" font-family:Courier New;">HeatTank&lt;/span> is equivalent to the definition of HeatTankExpanded&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model HeatTankExpanded  //Modelica Book version, Added start values etc.
  parameter Real Area=1;          // and some inlet and outlet equations
  TankStream inlet, outlet;
  Real level(start=2);
  Real temp;

  connector TankStream
    Real pressure;
    flow Real volumeFlowRate;
    Real temp;
  end TankStream;

equation
  inlet.volumeFlowRate = 1;
  inlet.pressure = 1;
  inlet.temp = 25;
 // Mass balance:
  Area*der(level) = inlet.volumeFlowRate + outlet.volumeFlowRate;
  outlet.pressure = inlet.pressure;
  // Energy balance:
  Area*level*der(temp) = inlet.volumeFlowRate * inlet.temp +
                         outlet.volumeFlowRate * outlet.temp;

  outlet.temp = temp;
  outlet.volumeFlowRate = 2;
end HeatTankExpanded;</Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>instantiateModel(HeatTankExpanded)</Input>
     <Output>"fclass HeatTankExpanded
parameter Real Area = 1;
Real inlet.pressure;
Real inlet.volumeFlowRate;
Real inlet.temp;
Real outlet.pressure;
Real outlet.volumeFlowRate;
Real outlet.temp;
Real level(start = 2.0);
Real temp;
equation
  inlet.volumeFlowRate = 1.0;
  inlet.pressure = 1.0;
  inlet.temp = 25.0;
  Area * der(level) = inlet.volumeFlowRate + outlet.volumeFlowRate;
  outlet.pressure = inlet.pressure;
  Area * level * der(temp) = inlet.volumeFlowRate * inlet.temp + outlet.volumeFlowRate * outlet.temp;
  outlet.temp = temp;
  outlet.volumeFlowRate = 2.0;
end HeatTankExpanded;
"</Output>
    </InputCell>
    <TextCell style="Subsection" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;span style=" font-family:Times; font-size:14pt; font-weight:600;">Simulation of HeadTankExpanded&lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">Simulate it:&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>simulate(HeatTankExpanded)</Input>
     <Output>record
    resultFile = "HeatTankExpanded_res.plt"
end record</Output>
    </InputCell>
    <InputCell style="Input" closed="false" >
     <Input>plot({level,temp})</Input>
     <Output>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Courier New; font-size:11pt; color:#000000;">&lt;img src="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/39.png" width="492" height="250" />&lt;/p>&lt;/body>&lt;/html></Output>
     <Image name="file:///C:/OpenModelica1.4.3/bin/OMNoteboook_tempfiles/39.png" >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</Image>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
   </GroupCell>
   <GroupCell closed="false" >
    <TextCell style="Section" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">&lt;span style=" font-family:Times; font-size:18pt; font-weight:600;">Old Version of HeatTankExpanded with too few equations&lt;/span>&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">The definition of &lt;span style=" font-family:Courier New;">HeatTank&lt;/span> is equivalent to the definition of HeatTankExpanded&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>model HeatTankExpanded  //??Old Modelica Book version, start values needed
  parameter Real Area=1;     // Incomplete version
  TankStream inlet, outlet;
  Real level;
  Real temp;

  connector TankStream
    Real pressure;
    flow Real volumeFlowRate;
    Real temp;
  end TankStream;

equation
  // Mass balance:
  Area*der(level) = inlet.volumeFlowRate + outlet.volumeFlowRate;
  outlet.pressure = inlet.pressure;
  // Energy balance:
  Area*level*der(temp) = inlet.volumeFlowRate * inlet.temp +
                         outlet.volumeFlowRate * outlet.temp;
  outlet.temp = temp;
end HeatTankExpanded;</Input>
     <Output>Ok</Output>
    </InputCell>
    <TextCell style="Text" >
     <Text>&lt;html>&lt;head>&lt;meta name="qrichtext" content="1" />&lt;/head>&lt;body style=" white-space: pre-wrap; font-family:MS Shell Dlg; font-size:8.25pt; font-weight:400; font-style:normal; text-decoration:none;">&lt;p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:Times New Roman; font-size:12pt; color:#000000;">Simulate it:&lt;/p>&lt;/body>&lt;/html></Text>
    </TextCell>
    <InputCell style="Input" closed="false" >
     <Input>simulate(HeatTankExpanded)</Input>
     <Output>record
    resultFile = "Simulation failed.
Too few equations, underdetermined system. The model has 6 variables and 2 equations
"
end record</Output>
    </InputCell>
   </GroupCell>
  </GroupCell>
 </GroupCell>
</Notebook>
